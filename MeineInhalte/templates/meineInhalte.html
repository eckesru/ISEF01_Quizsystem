{% extends "base.html" %} {% block content %}

<script>
  document.addEventListener("DOMContentLoaded", function () {
    function loadFrageContent(url, targetElementId) {
      fetch(url)
        .then((response) => response.text())
        .then((data) => {
          var targetElement = document.getElementById(targetElementId);
          if (targetElement) {
            targetElement.innerHTML = data;
          } else {
            console.error("Error: Target element not found");
          }
        })
        .catch((error) => console.error("Error:", error));
    }

    console.log("paginator.js geladen");

    // Hier kannst du weitere Funktionen oder Code hinzufügen, wenn nötig
  });
</script>

<div id="meineInhalte">
  <!--Fragen Container-->
  <div class="frage-container">
    <h2>Meine Fragen</h2>

    <!--Schleife durch einzelne Fragen des Users-->
    {% for frage in page_frage %}
    <div class="frage">
      <!--Frage Metaangaben-->
      <div class="frage-meta">
        <span class="frage-username">{{ frage.user.username }}</span>
        <span class="frage-erstelldatum"
          >{{ frage.creation_date|date:"Y-m-d H:i" }}</span
        >
      </div>

      <!--Frage Überschrift mit Link zur Frage anzeigen-->
      <h3>
        <a href="{% url 'frage-anzeigen' frage.id %}"
          >{{ frage.module.text }}: {{ frage.title }}</a
        >
      </h3>

      <!--Frage Text-->
      <div class="frage-text frage-text_overflow">{{ frage.text|safe }}</div>

      <!--Frage Tags-->
      <div class="tags">
        <i class="fas fa-tags"></i>
        {% for tag in frage.tag.all %}
        <span class="tag">{{ tag.text }}</span>
        {% endfor %}
      </div>

      <!--Frage Buttons laden-->
      {% include "frage_actions.html" %}
    </div>
    {% endfor %}

    <!--Paginator für Fragen-->
    <div class="pagination">
      <span class="step-links">
        {% if page_frage.has_previous %}
        <a href="?seite=1">&laquo; first</a>
        <a href="?seite={{ page_frage.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
          Seite {{ page_frage.number }} von {{ page_frage.paginator.num_pages }}
        </span>

        {% if page_frage.has_next %}
        <!--
        <a href="?seite={{ page_frage.next_page_number }}">next</a>
        <a href="?seite={{ page_frage.paginator.num_pages }}">last &raquo;</a>
        -->
        <a
          href="javascript:void(0);"
          onclick="loadFrageContent('?seite={{ page_frage.next_page_number }}', 'fragen-container'); console.log('next clicked');"
          >nächste</a
        >
        <a
          href="javascript:void(0);"
          onclick="loadFrageContent('?seite={{ page_frage.paginator.num_pages }}', 'fragen-container'); console.log('last clicked');"
          >letzte &raquo;</a
        >
        {% endif %}
      </span>
    </div>
  </div>

  <!--Antworten Container-->
  <div class="antwort-container">
    <h2>Meine Antworten</h2>

    <!--Schleife durch einzelne Antworten des Users-->
    {% for antwort in page_antwort %}
    <div class="antwort">
      <!--Antwort Metaangaben-->
      <div class="antwort-meta">
        <span class="antwort-username">{{ antwort.user.username }}</span>
        <span class="antwort-erstelldatum"
          >{{ antwort.creation_date|date:"Y-m-d H:i" }}</span
        >
      </div>

      <!--Antwort Text-->
      <div class="antwort-text antwort-text_overflow">
        {{ antwort.text|safe }}
      </div>

      <!--Antwort Buttons laden-->
      {% include "antwort_actions.html" %}
    </div>
    {% endfor %}

    <!--Paginator für Antworten-->
    <div class="pagination">
      <span class="step-links">
        {% if page_antwort.has_previous %}
        <a href="?seite=1">&laquo; first</a>
        <a href="?seite={{ page_antwort.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
          Seite {{ page_antwort.number }} von {{
          page_antwort.paginator.num_pages }}
        </span>

        {% if page_antwort.has_next %}
        <a href="?seite={{ page_antwort.next_page_number }}">next</a>
        <a href="?seite={{ page_antwort.paginator.num_pages }}">last &raquo;</a>
        {% endif %}
      </span>
    </div>
  </div>
</div>
{% endblock %}
